CREATE TABLE property(
    property_id VARCHAR(7),
    name VARCHAR(255),
    type VARCHAR(50),
    state VARCHAR(255),
    zipcode VARCHAR(8),
    city VARCHAR(255),
    country VARCHAR(255),
    address VARCHAR(255),
    bedrooms INT,
    units INT,
    bathrooms INT,
    year_built DATETIME,
    floor_plan TEXT,
    size INT,
    parking VARCHAR(3),
    furnished VARCHAR(3),
    rent INT,
    renting_status VARCHAR(3),
    owner_id INT(11),
    PRIMARY KEY(property_id),
    FOREIGN KEY(owner_id) REFERENCES person(pid) ON DELETE CASCADE
);

CREATE TABLE booking(
    booking_id INT(11) AUTO_INCREMENT,
    property_id INT(11),
    tenant_id INT(11),
    agent_id INT(11),
    booked_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    renting_period INT,
    PRIMARY KEY(booking_id),
    FOREIGN KEY(property_id) REFERENCES property(property_id) ON DELETE CASCADE,
    FOREIGN KEY(tenant_id) REFERENCES person(pid) ON DELETE CASCADE,
    FOREIGN KEY(agent_id) REFERENCES person(pid) ON DELETE CASCADE
);

CREATE TABLE property_images(
    image_id INT AUTO_INCREMENT,
    property_id VARCHAR(7),
    image_url TEXT,
    PRIMARY KEY(image_id),
    FOREIGN KEY(property_id) REFERENCES property(property_id) ON DELETE CASCADE
);

CREATE TABLE property (
  property_id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  type ENUM('short term', 'monthly', 'service only') NOT NULL,
  address VARCHAR(255) NOT NULL,
  zipcode VARCHAR(20) NOT NULL,
  city VARCHAR(100) NOT NULL,
  state_province VARCHAR(100) NOT NULL,
  country VARCHAR(100) NOT NULL,
  year_built INT(4) NOT NULL,
  rent_on_basis DECIMAL(10, 2) NOT NULL,  -- Rent amount depending on the type
  units INT(11) NOT NULL,
  size_sqr_ft INT(11) NOT NULL,  -- Size in square feet
  bedrooms INT(2) NOT NULL,
  bathrooms INT(2) NOT NULL,
  parking VARCHAR(3) NOT NULL,
  furnished VARCHAR(3) NOT NULL,
  floor_plan TEXT NOT NULL,  -- Description of unit arrangement
  status ENUM('active', 'inactive', 'under maintenance', 'sold', 'pending') NOT NULL DEFAULT 'active', -- Status of the property
  person_id INT(11) NOT NULL,  -- Assuming a foreign key reference to person (optional)
  FOREIGN KEY (person_id) REFERENCES person(pid) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Create the 'property_image' table with a foreign key to 'property' (status removed)
CREATE TABLE property_image (
  image_url VARCHAR(255) PRIMARY KEY,
  property_id INT(11) NOT NULL,
  FOREIGN KEY (property_id) REFERENCES property(property_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Create the 'property_deed_image' table with a foreign key to 'property' (status removed)
CREATE TABLE property_deed_image (
  image_url VARCHAR(255) PRIMARY KEY,
  property_id INT(11) NOT NULL,
  FOREIGN KEY (property_id) REFERENCES property(property_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;